# USART.c更改解析
**目的** ：不再使用HAL库的HAL_UART_Transmit函数发送数据，改用更简便的printf  
原来是：  
`char buffer[] = "Hello World\r\n";`  
`HAL_UART_Transmit(&huart1, (uint8_t*)buffer, strlen(buffer), HAL_MAX_DELAY); `  
现在可以直接调用为  
`printf("Hello World\r\n");`  
添加部分：
```
struct __FILE 
{ 
	int handle; 
 
};
```
 作用：
定义一个简化的FILE结构体
在嵌入式系统中，不需要完整的文件操作，只需一个最小实现
handle字段通常用于标识文件描述符，但在这里基本不用  
为什么需要？
标准库的printf等函数需要一个FILE*参数，即使我们不真正使用文件系统。
```
FILE __stdout;       
 ```
标准输出文件句柄

```
void _sys_exit(int x) 
{ 
	x = x; 
} 

int fputc(int ch, FILE *f)
{      
    HAL_UART_Transmit (&huart1 ,(uint8_t *)&ch,1,HAL_MAX_DELAY );
	return ch;}

```
这是STM32 HAL库的串口发送函数，参数分解：

&huart1 - USART1的句柄指针

这是一个全局变量，在其他地方已初始化
包含了USART1的所有配置信息
(uint8_t *)&ch - 数据指针

&ch获取字符ch的地址
(uint8_t *)将其转换为无符号8位整数指针
因为HAL_UART_Transmit期望一个字节数组
1 - 数据长度

每次只发送一个字节（一个字符）
HAL_MAX_DELAY - 超时时间

表示函数将无限等待直到发送完成
其他选项：HAL_DELAY(ms)指定具体毫秒数
return ch;
如果发送成功，返回发送的字符
符合fputc的标准行为
如果发送失败，HAL_UART_Transmit会返回错误，但这里没有处理错误情况
